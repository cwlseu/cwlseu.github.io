---
layout: blog
title: "从HOG到FHOG"
description: "Welcome to my world!"
---

声明：本博客欢迎转发，但请保留原作者信息! 
作者: [Clython]
博客： [https://cwlseu.github.io/](https://cwlseu.github.io/)


# 从HOG到FHOG

## 从特征描述子说起
1. Haar
2. SIFT
3. HOG(Histogram of Oriented Gradient)
    在计算机视觉和图像处理中用来进行物体检测的特征描述子，它通过计算和统计图像局部区域
的梯度方向直方图构成特征。Hog特征结合分类算法广泛应用于图像识别中，尤其是
在行人检测中获得极大成功。HOG+SVM的行人检测方法2005年提出来之后，如今很多
行人检测算法都是以此为思路的。

## HOG特征描述子有什么特性
  
        在一副图像中，局部目标的表象和形状（appearance and shape）能够被梯度或边缘的方向密度分布很好地描述。（本质：梯度的统计信息，而梯度主要存在于边缘的地方）

### 实现方法
1. 首先将图像分成小的连通区域，我们把它叫**细胞单元**。然后采集细胞单元中各像素点的梯度的或边缘的方向直方图。最后把这些直方图组合起来就可以构成特征描述器。
2. 为了提高性能，把这些局部直方图在图像的**更大的范围内（我们把它叫区间或block）**进行对比度归一化（contrast-normalized），所采用的方法是：先计算各直方图在这个**block**中的密度，然后根据这个密度对**block**中的各个**细胞单元**做归一化。通过这个归一化后，能对光照变化和阴影获得更好的效果。

### 算法步骤
HOG特征提取方法就是将一个image（你要检测的目标或者扫描窗口）：
1）灰度化（将图像看做一个x,y,h（灰度）的三维图像）；
2）采用Gamma校正法对输入图像进行**颜色空间的标准化（归一化）**；目的是调节图像的对比度，降低图像局部的阴影和光照变化所造成的影响，同时可以抑制噪音的干扰；
    
        为了减少光照因素的影响，首先需要将整个图像进行规范化（归一化）。在图像的纹理强度中，局部的表层曝光贡献的比重较大，所以，这种压缩处理能够有效地降低图像局部的阴影和光照变化。因为颜色信息作用不大，通常先转化为灰度图；
        $$I(x, y) = I(x, y)^ gramma$$通常gamma取0.5

3）计算图像每个像素的梯度（包括大小和方向）；主要是为了捕获轮廓信息，同时进一步弱化光照的干扰。

图像中像素点的梯度：
    $$G_x(x, y) = H(x+1, y) - H(x-1, y)$$
    $$G_y(x, y) = H(x, y+1) - H(x, y-1)$$
    $$G(x, y) = \sqrt{G_x(x, y)^2 + G_y(x, y)^2}$$
    $$\alpha(x, y) = tan^{-1}{\frac{G_y(x, y)}{G_x(x, y)}}$$

实际实现的时候，首先用[-1,0,1]梯度算子对原图像做卷积运算，得到x方向（水平方向，以向右为正方向）的梯度分量gradscalx，然后用[1,0,-1]T梯度算子对原图像做卷积运算，得到y方向（竖直方向，以向上为正方向）的梯度分量gradscaly。然后再用以上公式计算该像素点的梯度大小和方向。
4）将图像划分成小cells（例如6*6像素/cell）；
5）统计每个cell的梯度直方图（不同梯度的个数），即可形成每个cell的descriptor；
6）将每几个cell组成一个block（例如3*3个cell/block），一个block内所有cell的特征descriptor串联起来便得到该block的HOG特征descriptor。
7）将图像image内的所有block的HOG特征descriptor串联起来就可以得到该image（你要检测的目标）的HOG特征descriptor了。这个就是最终的可供分类使用的特征向量了。